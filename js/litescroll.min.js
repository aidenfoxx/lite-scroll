/** 
 * Lite Scroll
 * 
 * @version    0.2
 * @author     Aiden Foxx
 * @license    MIT License 
 * @copyright  2015 Aiden Foxx
 * @link       http://github.com/aidenfoxx
 * @twitter    @furiousfoxx
 */
"use strict";function LiteScroll(t,e){if(!(this instanceof LiteScroll))return new LiteScroll(t,e);this.element=t,this.content=t.children[0],this.lockScroll=null,this.resizeTimeout=null,this.dragEvent=null,this.dragStart=null,this.x=0,this.y=0,this.scrollStartVec={x:0,y:0},this.prevScrollVec={x:0,y:0},this.options={scrollX:!1,scrollY:!0,snap:!1,snapSpeed:300,dynamicResize:!0,lockScroll:!0,momentum:!0,momentumSpeed:4};for(var i in e)this.options[i]=e[i];this.elementRect=this.element.getBoundingClientRect(),this.contentRect=this.content.getBoundingClientRect(),this.childRect=this.options.snap?this.getChildRect():[],this.bindEvents()}LiteScroll.prototype.scrollStart=function(){},LiteScroll.prototype.scroll=function(){},LiteScroll.prototype.scrollEnd=function(){},LiteScroll.prototype.calcRelativePos=function(t,e){return{x:t-this.elementRect.left,y:e-this.elementRect.top}},LiteScroll.prototype.clacPointDistance=function(t,e){var i=e.x-t.x,s=e.y-t.y;return Math.sqrt(i*i+s*s)},LiteScroll.prototype.getChildRect=function(){var t=[],e=this.content.style.transform;this.content.style.transitionDuration="0ms",this.content.style.transform="translate(0px, 0px) translateZ(0px)";for(var i=0,s=this.content.children.length;s>i;i++)t.push(this.content.children[i].getBoundingClientRect());return this.content.style.transform=e,t},LiteScroll.prototype.getTouchCoords=function(t){return this.calcRelativePos(t.changedTouches?t.changedTouches[0].pageX:t.pageX,t.changedTouches?t.changedTouches[0].pageY:t.pageY)},LiteScroll.prototype.bindEvents=function(){this.element.addEventListener("mousedown",this._scrollStart.bind(this)),this.element.addEventListener("touchstart",this._scrollStart.bind(this)),window.addEventListener("mouseup",this._scrollEnd.bind(this)),window.addEventListener("touchend",this._scrollEnd.bind(this)),window.addEventListener("touchcancel",this._scrollEnd.bind(this)),this.options.dynamicResize&&window.addEventListener("resize",this.resize.bind(this))},LiteScroll.prototype.resize=function(){clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){this.elementRect=this.element.getBoundingClientRect(),this.contentRect=this.content.getBoundingClientRect(),this.childRect=this.options.snap?this.getChildRect():[]}.bind(this),500)},LiteScroll.prototype.scrollTo=function(t,e,i,s){var o=this.contentRect.width-this.elementRect.width,n=this.contentRect.height-this.elementRect.height;this.x=t,this.y=e,(t>0||-o>t)&&(this.x=t>0?0:-o),(e>0||-n>e)&&(this.y=e>0?0:-n),this.content.style.transitionDuration=i+"ms",this.content.style.transitionTimingFunction=s,this.content.style.transform="translate("+this.x+"px, "+this.y+"px) translateZ(0px)"},LiteScroll.prototype._scrollStart=function(t){t.preventDefault(),this.dragEvent||(this.dragStart=Date.now(),this.scrollStartVec=this.getTouchCoords(t),this.dragEvent=this._scroll.bind(this),this.element.addEventListener("mousemove",this.dragEvent),this.element.addEventListener("touchmove",this.dragEvent),this.scrollStart(t))},LiteScroll.prototype._scroll=function(t){t.preventDefault();var e=this.getTouchCoords(t),i=e.x-this.scrollStartVec.x,s=e.y-this.scrollStartVec.y;this.options.lockScroll&&!this.lockScroll&&(this.options.scrollX&&(i>20||-20>i)&&20>s&&s>-20&&(this.lockScroll="x"),this.options.scrollY&&(s>20||-20>s)&&20>i&&i>-20&&(this.lockScroll="y"));var o=this.options.scrollX&&"y"!==this.lockScroll?this.prevScrollVec.x+i:this.x,n=this.options.scrollY&&"x"!==this.lockScroll?this.prevScrollVec.y+s:this.y;this.scrollTo(o,n,0,"linear"),this.scroll(t)},LiteScroll.prototype._scrollEnd=function(t){if(this.options.snap){for(var e=null,i={x:0,y:0},s=0,o=this.childRect.length;o>s;s++){var n=this.calcRelativePos(this.childRect[s].left,this.childRect[s].top);n.x=-n.x,n.y=-n.y;var l=this.clacPointDistance(this,n);(!s||e>l)&&(e=l,i=n)}this.scrollTo(i.x,i.y,this.options.snapSpeed,"cubic-bezier(0.1, 0.57, 0.1, 1)")}else if(this.options.momentum){var n=this.getTouchCoords(t),c=Date.now()-this.dragStart,r=c*this.options.momentumSpeed,h=n.x-this.scrollStartVec.x,a=n.y-this.scrollStartVec.y,d=h/c,p=a/c,u=this.prevScrollVec.x+n.x+d*r,m=this.prevScrollVec.y+n.y+p*r;this.scrollTo(u,m,r,"cubic-bezier(0.165, 0.840, 0.440, 1.000)")}this.prevScrollVec.x=this.x,this.prevScrollVec.y=this.y,this.element.removeEventListener("mousemove",this.dragEvent),this.element.removeEventListener("touchmove",this.dragEvent),this.dragEvent=null,this.lockScroll=null,this.scrollEnd(t)};