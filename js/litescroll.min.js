/** 
 * Lite Scroll
 * 
 * @version    0.2.1
 * @author     Aiden Foxx
 * @license    MIT License 
 * @copyright  2015 Aiden Foxx
 * @link       http://github.com/aidenfoxx
 * @twitter    @furiousfoxx
 */
"use strict";function LiteScroll(t,i){if(!(this instanceof LiteScroll))return new LiteScroll(t,i);this.container=t,this.content=t.children[0],this.lockScroll=null,this.resizeTimeout=null,this.dragEvent=null,this.dragStart=null,this.x=0,this.y=0,this.scrollStartVec={x:0,y:0},this.prevScrollVec={x:0,y:0},this.options={scrollX:!1,scrollY:!0,snap:!1,snapSpeed:300,dynamicResize:!0,lockScroll:!0,momentum:!0,momentumFalloff:.008};for(var o in i)this.options[o]=i[o];this.containerRect=this.container.getBoundingClientRect(),this.contentRect=this.content.getBoundingClientRect(),this.childRect=this.options.snap?this.getChildRect():[],this.bindEvents()}LiteScroll.prototype.scrollStart=function(){},LiteScroll.prototype.scroll=function(){},LiteScroll.prototype.scrollEnd=function(){},LiteScroll.prototype.calcRelativePos=function(t,i){return{x:t-this.containerRect.left,y:i-this.containerRect.top}},LiteScroll.prototype.calcTouchCoords=function(t){return this.calcRelativePos(t.changedTouches?t.changedTouches[0].pageX:t.pageX,t.changedTouches?t.changedTouches[0].pageY:t.pageY)},LiteScroll.prototype.clacPointDistance=function(t,i){var o=i.x-t.x,e=i.y-t.y;return Math.sqrt(o*o+e*e)},LiteScroll.prototype.getChildRect=function(){var t=[],i=this.content.style.transform;this.content.style.transitionDuration="0ms",this.content.style.transform="translate(0px, 0px) translateZ(0px)";for(var o=0,e=this.content.children.length;e>o;o++)t.push(this.content.children[o].getBoundingClientRect());return this.content.style.transform=i,t},LiteScroll.prototype.bindEvents=function(){this.container.addEventListener("mousedown",this._scrollStart.bind(this)),this.container.addEventListener("touchstart",this._scrollStart.bind(this)),window.addEventListener("mouseup",this._scrollEnd.bind(this)),window.addEventListener("touchend",this._scrollEnd.bind(this)),window.addEventListener("touchcancel",this._scrollEnd.bind(this)),this.options.dynamicResize&&window.addEventListener("resize",this.resize.bind(this))},LiteScroll.prototype.resize=function(){clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){this.containerRect=this.container.getBoundingClientRect(),this.contentRect=this.content.getBoundingClientRect(),this.childRect=this.options.snap?this.getChildRect():[]}.bind(this),500)},LiteScroll.prototype.scrollTo=function(t,i,o,e){var s=this.contentRect.width-this.containerRect.width,n=this.contentRect.height-this.containerRect.height;this.x=t,this.y=i,(t>0||-s>t)&&(this.x=t>0?0:-s),(i>0||-n>i)&&(this.y=i>0?0:-n),this.content.style.transitionDuration=o+"ms",this.content.style.transitionTimingFunction=e,this.content.style.transform="translate("+Math.round(this.x)+"px, "+Math.round(this.y)+"px) translateZ(0px)"},LiteScroll.prototype._scrollStart=function(t){t.preventDefault(),this.dragEvent||(this.dragStart=Date.now(),this.scrollStartVec=this.calcTouchCoords(t),this.dragEvent=this._scroll.bind(this),this.container.addEventListener("mousemove",this.dragEvent),this.container.addEventListener("touchmove",this.dragEvent),this.scrollStart(t))},LiteScroll.prototype._scroll=function(t){t.preventDefault();var i=this.calcTouchCoords(t),o=i.x-this.scrollStartVec.x,e=i.y-this.scrollStartVec.y;this.options.lockScroll&&!this.lockScroll&&(this.options.scrollX&&(o>20||-20>o)&&20>e&&e>-20&&(this.lockScroll="x"),this.options.scrollY&&(e>20||-20>e)&&20>o&&o>-20&&(this.lockScroll="y"));var s=this.options.scrollX&&"y"!==this.lockScroll?this.prevScrollVec.x+o:this.x,n=this.options.scrollY&&"x"!==this.lockScroll?this.prevScrollVec.y+e:this.y;this.scrollTo(s,n,0,"linear"),this.scroll(t)},LiteScroll.prototype._scrollEnd=function(t){if(this.dragEvent){if(this.options.snap){for(var i=null,o={x:0,y:0},e=0,s=this.childRect.length;s>e;e++){var n=this.calcRelativePos(this.childRect[e].left,this.childRect[e].top);n.x=-n.x,n.y=-n.y;var c=this.clacPointDistance(this,n);(!e||i>c)&&(i=c,o=n)}this.scrollTo(o.x,o.y,this.options.snapSpeed,"cubic-bezier(0.1, 0.55, 0.1, 1)")}else if(this.options.momentum){var n=this.calcTouchCoords(t),l=Date.now()-this.dragStart,r=(n.x-this.scrollStartVec.x)/l,h=(n.y-this.scrollStartVec.y)/l,a=Math.abs("x"===this.lockScroll||Math.abs(r)>Math.abs(h)?r:h)/this.options.momentumFalloff,d="y"!==this.lockScroll?this.x+Math.abs(r)*r/(2*this.options.momentumFalloff):this.x,u="x"!==this.lockScroll?this.y+Math.abs(h)*h/(2*this.options.momentumFalloff):this.y;this.scrollTo(d?d:this.x,u?u:this.y,a,"cubic-bezier(0.25, 0.45, 0.45, 0.95)")}this.prevScrollVec.x=this.x,this.prevScrollVec.y=this.y,this.container.removeEventListener("mousemove",this.dragEvent),this.container.removeEventListener("touchmove",this.dragEvent),this.dragEvent=null,this.lockScroll=null,this.scrollEnd(t)}};