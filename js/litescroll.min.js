/** 
 * Lite Scroll
 * 
 * @version    0.3.1
 * @author     Aiden Foxx
 * @license    MIT License 
 * @copyright  2015 Aiden Foxx
 * @link       http://github.com/aidenfoxx
 * @twitter    @furiousfoxx
 */
"use strict";function LiteScroll(t,i){if(!(this instanceof LiteScroll))return new LiteScroll(t,i);this.container=t,this.content=t.children[0],this.scrollCallback=null,this.scrollLock=null,this.scrollEvent=null,this.scrollBegin=null,this.scrollFrame=null,this.scrollInitVec={x:0,y:0},this.scrollInitMouseVec={x:0,y:0},this.resizeTimeout=null,this.x=0,this.y=0,this.options={scrollX:!1,scrollY:!0,snap:!1,snapSpeed:300,dynamicResize:!0,scrollLock:!0,scrollLockThreshold:20,momentum:!0,momentumFalloff:.006};for(var s in i)this.options[s]=i[s];this.containerRect=this.container.getBoundingClientRect(),this.contentRect=this.content.getBoundingClientRect(),this.childRect=this.getChildRect(),this.bindEvents()}LiteScroll.prototype.scrollStart=function(){},LiteScroll.prototype.scroll=function(){},LiteScroll.prototype.scrollEnd=function(){},LiteScroll.prototype.calcRelativePos=function(t,i){return{x:t-this.containerRect.left,y:i-this.containerRect.top}},LiteScroll.prototype.calcTouchCoords=function(t){return this.calcRelativePos(t.changedTouches?t.changedTouches[0].pageX:t.pageX,t.changedTouches?t.changedTouches[0].pageY:t.pageY)},LiteScroll.prototype.clacPointDistance=function(t,i){var s=i.x-t.x,o=i.y-t.y;return Math.sqrt(s*s+o*o)},LiteScroll.prototype.getChildRect=function(){var t=[],i=this.content.style.transform;this.content.style.transitionDuration="0ms",this.content.style.transform="translate(0px, 0px)";for(var s=0,o=this.content.children.length;o>s;s++)t.push(this.content.children[s].getBoundingClientRect());return this.content.style.transform=i,t},LiteScroll.prototype.bindEvents=function(){this.container.addEventListener("mousedown",this._scrollStart.bind(this)),this.container.addEventListener("touchstart",this._scrollStart.bind(this)),window.addEventListener("mouseup",this._scrollEnd.bind(this)),window.addEventListener("touchend",this._scrollEnd.bind(this)),window.addEventListener("touchcancel",this._scrollEnd.bind(this)),this.options.dynamicResize&&window.addEventListener("resize",this.resize.bind(this))},LiteScroll.prototype.resize=function(){clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){this.containerRect=this.container.getBoundingClientRect(),this.contentRect=this.content.getBoundingClientRect(),this.childRect=this.getChildRect(),this.snapToNearest()}.bind(this),500)},LiteScroll.prototype.scrollTo=function(t,i,s,o,e){var n=!1;if(t=Math.round(t),i=Math.round(i),this.options.scrollX&&"y"!==this.scrollLock&&this.x!==t){var l=this.contentRect.width-this.containerRect.width;if(t>0||-l>t){var c=this.x-t;t=t>0?0:-l,n=Math.abs(this.x-t)/Math.abs(c)}this.x=t}if(this.options.scrollY&&"x"!==this.scrollLock&&this.y!==i){var r=this.contentRect.height-this.containerRect.height;if(i>0||-r>i){var h=this.y-i;i=i>0?0:-r;var a=Math.abs(this.y-i)/Math.abs(h);n=!n||n>a?a:n}this.y=i}n&&(s*=n),this.content.style.transitionDuration=s+"ms",this.content.style.transitionTimingFunction=o,this.content.style.transform="translate("+this.x+"px, "+this.y+"px) translateZ(0px)",clearTimeout(this.scrollCallback),e&&(this.scrollCallback=setTimeout(e.bind(this),s))},LiteScroll.prototype.snapTo=function(t,i){var s=this.calcRelativePos(this.childRect[t].left,this.childRect[t].top);this.scrollTo(-s.x,-s.y,this.options.snapSpeed,"cubic-bezier(0.1, 0.55, 0.1, 1)",i)},LiteScroll.prototype.snapToNearest=function(t){for(var i=null,s=0,o=0,e=this.childRect.length;e>o;o++){var n=this.calcRelativePos(this.childRect[o].left,this.childRect[o].top);n.x=-n.x,n.y=-n.y;var l=this.clacPointDistance(this,n);(!o||i>l)&&(i=l,s=o)}this.snapTo(s,t)},LiteScroll.prototype._scrollStart=function(t){t.preventDefault(),this.scrollEvent||(this.scrollBegin=Date.now(),this.scrollInitMouseVec=this.calcTouchCoords(t),this.scrollInitVec={x:this.x,y:this.y},this.scrollEvent=this._scroll.bind(this),this.container.addEventListener("mousemove",this.scrollEvent),this.container.addEventListener("touchmove",this.scrollEvent),this.scrollStart(t))},LiteScroll.prototype._scroll=function(t){t.preventDefault(),window.cancelAnimationFrame(this.scrollFrame),this.scrollFrame=window.requestAnimationFrame(function(){this._scrollFrame(t)}.bind(this))},LiteScroll.prototype._scrollFrame=function(t){var i=this.calcTouchCoords(t),s=i.x-this.scrollInitMouseVec.x,o=i.y-this.scrollInitMouseVec.y;this.options.scrollLock&&!this.scrollLock&&(this.options.scrollX&&Math.abs(s)>this.options.scrollLockThreshold&&(this.scrollLock="x"),this.options.scrollY&&Math.abs(o)>this.options.scrollLockThreshold&&(this.scrollLock="y")),this.scrollTo(this.scrollInitVec.x+s,this.scrollInitVec.y+o,0,"linear"),this.scroll(t)},LiteScroll.prototype._scrollEnd=function(t){if(this.scrollEvent){if(window.cancelAnimationFrame(this.scrollFrame),this.options.momentum){var i=this.calcTouchCoords(t),s=Date.now()-this.scrollBegin,o=(i.x-this.scrollInitMouseVec.x)/s,e=(i.y-this.scrollInitMouseVec.y)/s,n=Math.abs("x"===this.scrollLock||Math.abs(o)>Math.abs(e)?o:e)/this.options.momentumFalloff,l=this.x+Math.abs(o)*o/(2*this.options.momentumFalloff),c=this.y+Math.abs(e)*e/(2*this.options.momentumFalloff);this.scrollTo(l,c,n,"cubic-bezier(0.165, 0.840, 0.440, 1.000)",this.options.snap?this.snapToNearest:null)}else this.options.snap&&this.snapToNearest();this.container.removeEventListener("mousemove",this.scrollEvent),this.container.removeEventListener("touchmove",this.scrollEvent),this.scrollEvent=null,this.scrollLock=null,this.scrollEnd(t)}};