/** 
 * Lite Scroll
 * 
 * @version    0.3.1
 * @author     Aiden Foxx
 * @license    MIT License 
 * @copyright  2015 Aiden Foxx
 * @link       http://github.com/aidenfoxx
 * @twitter    @furiousfoxx
 */
"use strict";function LiteScroll(t,s){if(!(this instanceof LiteScroll))return new LiteScroll(t,s);this.container=t,this.content=t.children[0],this.scrollCallback=null,this.scrollLock=null,this.scrollEvent=null,this.scrollBegin=null,this.scrollFrame=null,this.scrollInitVec={x:0,y:0},this.scrollInitMouseVec={x:0,y:0},this.resizeTimeout=null,this.x=0,this.y=0,this.options={scrollX:!1,scrollY:!0,snap:!1,snapSpeed:300,dynamicResize:!0,scrollLock:!0,scrollLockThreshold:20,momentum:!0,momentumFalloff:.006};for(var i in s)this.options[i]=s[i];this.containerRect=this.container.getBoundingClientRect(),this.contentRect=this.content.getBoundingClientRect(),this.childRect=this.getChildRect(),this.bindEvents()}LiteScroll.prototype.scrollStart=function(){},LiteScroll.prototype.scroll=function(){},LiteScroll.prototype.scrollEnd=function(){},LiteScroll.prototype.calcRelativePos=function(t,s){return{x:t-this.containerRect.left,y:s-this.containerRect.top}},LiteScroll.prototype.calcTouchCoords=function(t){return this.calcRelativePos(t.changedTouches?t.changedTouches[0].pageX:t.pageX,t.changedTouches?t.changedTouches[0].pageY:t.pageY)},LiteScroll.prototype.clacPointDistance=function(t,s){var i=s.x-t.x,o=s.y-t.y;return Math.sqrt(i*i+o*o)},LiteScroll.prototype.getChildRect=function(){var t=[],s=this.content.style.transform;this.content.style.transitionDuration="0ms",this.content.style.transform="translate(0px, 0px)";for(var i=0,o=this.content.children.length;o>i;i++)t.push(this.content.children[i].getBoundingClientRect());return this.content.style.transform=s,t},LiteScroll.prototype.bindEvents=function(){this.container.addEventListener("mousedown",this._scrollStart.bind(this)),this.container.addEventListener("touchstart",this._scrollStart.bind(this)),window.addEventListener("mouseup",this._scrollEnd.bind(this)),window.addEventListener("touchend",this._scrollEnd.bind(this)),window.addEventListener("touchcancel",this._scrollEnd.bind(this)),this.options.dynamicResize&&window.addEventListener("resize",this.resize.bind(this))},LiteScroll.prototype.resize=function(){clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){this.containerRect=this.container.getBoundingClientRect(),this.contentRect=this.content.getBoundingClientRect(),this.childRect=this.getChildRect(),this.snapToNearest()}.bind(this),500)},LiteScroll.prototype.scrollTo=function(t,s,i,o,e){var n=!1;if(t=Math.round(t),s=Math.round(s),this.options.scrollX&&"y"!==this.scrollLock&&this.x!==t){var l=this.contentRect.width-this.containerRect.width;if(t>0||-l>t){var c=this.x-t;t=t>0?0:-l,n=Math.abs(this.x-t)/Math.abs(c)}this.x=t}if(this.options.scrollY&&"x"!==this.scrollLock&&this.y!==s){var r=this.contentRect.height-this.containerRect.height;if(s>0||-r>s){var h=this.y-s;s=s>0?0:-r;var a=Math.abs(this.y-s)/Math.abs(h);n=!n||n>a?a:n}this.y=s}n&&(i*=n),this.content.style.transitionDuration=i+"ms",this.content.style.transitionTimingFunction=o,this.content.style.transform="translate("+this.x+"px, "+this.y+"px) translateZ(0px)",clearTimeout(this.scrollCallback),e&&(this.scrollCallback=setTimeout(e.bind(this),i))},LiteScroll.prototype.snapTo=function(t,s){var i=this.calcRelativePos(this.childRect[t].left,this.childRect[t].top);this.scrollTo(-i.x,-i.y,this.options.snapSpeed,"cubic-bezier(0.1, 0.55, 0.1, 1)",s)},LiteScroll.prototype.snapToNearest=function(t){for(var s=null,i=0,o=0,e=this.childRect.length;e>o;o++){var n=this.calcRelativePos(this.childRect[o].left,this.childRect[o].top);n.x=-n.x,n.y=-n.y;var l=this.clacPointDistance(this,n);(!o||s>l)&&(s=l,i=o)}this.snapTo(i,t)},LiteScroll.prototype._scrollStart=function(t){t.preventDefault(),this.scrollEvent||(this.scrollBegin=Date.now(),this.scrollInitMouseVec=this.calcTouchCoords(t),this.scrollInitVec={x:this.x,y:this.y},this.scrollEvent=this._scroll.bind(this),this.container.addEventListener("mousemove",this.scrollEvent),this.container.addEventListener("touchmove",this.scrollEvent),this.scrollStart(t))},LiteScroll.prototype._scroll=function(t){t.preventDefault(),window.cancelAnimationFrame(this.scrollFrame),this.scrollFrame=window.requestAnimationFrame(function(){this._scrollFrame(t)}.bind(this))},LiteScroll.prototype._scrollFrame=function(t){var s=this.calcTouchCoords(t),i=s.x-this.scrollInitMouseVec.x,o=s.y-this.scrollInitMouseVec.y;this.options.scrollLock&&!this.scrollLock&&(this.options.scrollX&&(i>this.options.scrollLockThreshold||i<-this.options.scrollLockThreshold)&&o<this.options.scrollLockThreshold&&o>-this.options.scrollLockThreshold&&(this.scrollLock="x"),this.options.scrollY&&(o>this.options.scrollLockThreshold||o<-this.options.scrollLockThreshold)&&i<this.options.scrollLockThreshold&&i>-this.options.scrollLockThreshold&&(this.scrollLock="y")),this.scrollTo(this.scrollInitVec.x+i,this.scrollInitVec.y+o,0,"linear"),this.scroll(t)},LiteScroll.prototype._scrollEnd=function(t){if(this.scrollEvent){if(window.cancelAnimationFrame(this.scrollFrame),this.options.momentum){var s=this.calcTouchCoords(t),i=Date.now()-this.scrollBegin,o=(s.x-this.scrollInitMouseVec.x)/i,e=(s.y-this.scrollInitMouseVec.y)/i,n=Math.abs("x"===this.scrollLock||Math.abs(o)>Math.abs(e)?o:e)/this.options.momentumFalloff,l=this.x+Math.abs(o)*o/(2*this.options.momentumFalloff),c=this.y+Math.abs(e)*e/(2*this.options.momentumFalloff);this.scrollTo(l,c,n,"cubic-bezier(0.315, 0.255, 0.000, 1)",this.options.snap?this.snapToNearest:null)}else this.options.snap&&this.snapToNearest();this.container.removeEventListener("mousemove",this.scrollEvent),this.container.removeEventListener("touchmove",this.scrollEvent),this.scrollEvent=null,this.scrollLock=null,this.scrollEnd(t)}};