/** 
 * Lite Scroll
 * 
 * @version    0.3.0
 * @author     Aiden Foxx
 * @license    MIT License 
 * @copyright  2015 Aiden Foxx
 * @link       http://github.com/aidenfoxx
 * @twitter    @furiousfoxx
 */
"use strict";function LiteScroll(t,i){if(!(this instanceof LiteScroll))return new LiteScroll(t,i);this.container=t,this.content=t.children[0],this.scrollCallback=null,this.scrollLock=null,this.resizeTimeout=null,this.dragEvent=null,this.dragStart=null,this.x=0,this.y=0,this.dragMouseVec={x:0,y:0},this.dragStartVec={x:0,y:0},this.options={scrollX:!1,scrollY:!0,snap:!1,snapSpeed:300,dynamicResize:!0,scrollLock:!0,scrollLockThreshold:20,momentum:!0,momentumFalloff:.008};for(var s in i)this.options[s]=i[s];this.containerRect=this.container.getBoundingClientRect(),this.contentRect=this.content.getBoundingClientRect(),this.childRect=this.options.snap?this.getChildRect():[],this.bindEvents()}LiteScroll.prototype.scrollStart=function(){},LiteScroll.prototype.scroll=function(){},LiteScroll.prototype.scrollEnd=function(){},LiteScroll.prototype.calcRelativePos=function(t,i){return{x:t-this.containerRect.left,y:i-this.containerRect.top}},LiteScroll.prototype.calcTouchCoords=function(t){return this.calcRelativePos(t.changedTouches?t.changedTouches[0].pageX:t.pageX,t.changedTouches?t.changedTouches[0].pageY:t.pageY)},LiteScroll.prototype.clacPointDistance=function(t,i){var s=i.x-t.x,o=i.y-t.y;return Math.sqrt(s*s+o*o)},LiteScroll.prototype.getChildRect=function(){var t=[],i=this.content.style.transform;this.content.style.transitionDuration="0ms",this.content.style.transform="translate(0px, 0px) translateZ(0px)";for(var s=0,o=this.content.children.length;o>s;s++)t.push(this.content.children[s].getBoundingClientRect());return this.content.style.transform=i,t},LiteScroll.prototype.bindEvents=function(){this.container.addEventListener("mousedown",this._scrollStart.bind(this)),this.container.addEventListener("touchstart",this._scrollStart.bind(this)),window.addEventListener("mouseup",this._scrollEnd.bind(this)),window.addEventListener("touchend",this._scrollEnd.bind(this)),window.addEventListener("touchcancel",this._scrollEnd.bind(this)),this.options.dynamicResize&&window.addEventListener("resize",this.resize.bind(this))},LiteScroll.prototype.resize=function(){clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){this.containerRect=this.container.getBoundingClientRect(),this.contentRect=this.content.getBoundingClientRect(),this.childRect=this.options.snap?this.getChildRect():[]}.bind(this),500)},LiteScroll.prototype.scrollTo=function(t,i,s,o,e){var n=!1;if(t=Math.round(t),i=Math.round(i),this.options.scrollX&&"y"!==this.scrollLock&&this.x!==t){var c=this.contentRect.width-this.containerRect.width;if(t>0||-c>t){var l=this.x-t;t=t>0?0:-c,n=Math.abs(this.x-t)/Math.abs(l)}this.x=t}if(this.options.scrollY&&"x"!==this.scrollLock&&this.y!==i){var r=this.contentRect.height-this.containerRect.height;if(i>0||-r>i){var h=this.y-i;i=i>0?0:-r;var a=Math.abs(this.y-i)/Math.abs(h);n=!n||n>a?a:n}this.y=i}n&&(s*=n),this.content.style.transitionDuration=s+"ms",this.content.style.transitionTimingFunction=o,this.content.style.transform="translate("+this.x+"px, "+this.y+"px) translateZ(0px)",clearTimeout(this.scrollCallback),e&&(this.scrollCallback=setTimeout(e.bind(this),s))},LiteScroll.prototype.snapTo=function(t,i){var s=this.calcRelativePos(this.childRect[t].left,this.childRect[t].top);this.scrollTo(-s.x,-s.y,this.options.snapSpeed,"cubic-bezier(0.1, 0.55, 0.1, 1)",i)},LiteScroll.prototype.snapToNearest=function(t){for(var i=null,s=0,o=0,e=this.childRect.length;e>o;o++){var n=this.calcRelativePos(this.childRect[o].left,this.childRect[o].top);n.x=-n.x,n.y=-n.y;var c=this.clacPointDistance(this,n);(!o||i>c)&&(i=c,s=o)}this.snapTo(s,t)},LiteScroll.prototype._scrollStart=function(t){t.preventDefault(),this.dragEvent||(this.dragStart=Date.now(),this.dragMouseVec=this.calcTouchCoords(t),this.dragStartVec={x:this.x,y:this.y},this.dragEvent=this._scroll.bind(this),this.container.addEventListener("mousemove",this.dragEvent),this.container.addEventListener("touchmove",this.dragEvent),this.scrollStart(t))},LiteScroll.prototype._scroll=function(t){t.preventDefault();var i=this.calcTouchCoords(t),s=i.x-this.dragMouseVec.x,o=i.y-this.dragMouseVec.y;this.options.scrollLock&&!this.scrollLock&&(this.options.scrollX&&(s>this.options.scrollLockThreshold||s<-this.options.scrollLockThreshold)&&o<this.options.scrollLockThreshold&&o>-this.options.scrollLockThreshold&&(this.scrollLock="x"),this.options.scrollY&&(o>this.options.scrollLockThreshold||o<-this.options.scrollLockThreshold)&&s<this.options.scrollLockThreshold&&s>-this.options.scrollLockThreshold&&(this.scrollLock="y")),this.scrollTo(this.dragStartVec.x+s,this.dragStartVec.y+o,0,"linear"),this.scroll(t)},LiteScroll.prototype._scrollEnd=function(t){if(this.dragEvent){var i=this.calcTouchCoords(t),s=Date.now()-this.dragStart,o=(i.x-this.dragMouseVec.x)/s,e=(i.y-this.dragMouseVec.y)/s,n=Math.abs("x"===this.scrollLock||Math.abs(o)>Math.abs(e)?o:e)/this.options.momentumFalloff,c=this.x+Math.abs(o)*o/(2*this.options.momentumFalloff),l=this.y+Math.abs(e)*e/(2*this.options.momentumFalloff);this.scrollTo(c,l,n,"cubic-bezier(0.25, 0.45, 0.45, 0.95)",this.snapToNearest),this.container.removeEventListener("mousemove",this.dragEvent),this.container.removeEventListener("touchmove",this.dragEvent),this.dragEvent=null,this.scrollLock=null,this.scrollEnd(t)}};